<?php

	class ExportController extends YiinigoController
	{
		
		public $layout="adminpage1";

		//untuk menampilkan data topografi
		public function actionIndex(){
			if(Yii::app()->user->isGuest){
		        $this->redirect(array('/login'));
			} else
		{
			$luaswilayah=LuasWilayah::model()->findAll();
			$topografi=Topografi::model()->findAll();
			$luaslahan=LuasLahan::model()->findAll();
			$iklimrata=IklimRata::model()->findAll();
			$pulau=JmlPulau::model()->findAll();
			$jmlgunung=JmlGunung::model()->findAll();
			$batasdarat=BatasDarat::model()->findAll();
			$fisiografi=Fisiografi::model()->findAll();
			$adminpmr=AdministrasiPemerintah::model()->findAll();
			$statotom=StatusOtonomi::model()->findAll();
			$perdaijin=PerdaIjin::model()->findAll();
			$sarpras=SarPras::model()->findAll();
			$konsarpras=KondisiSarPras::model()->findAll();
			$capil=Capil::model()->findAll();
			$orglahan=OrangPunyaLahan::model()->findAll();
			$famjob=FamJob::model()->findAll();
			$orgusia=OrangUsia::model()->findAll();
			$deprat=Deprat::model()->findAll();
			$datduk=PadatPenduduk::model()->findAll();
			$inoutsave=Inoutsave::model()->findAll();
			$tk=Ketenagakerjaan::model()->findAll();
			$pblmu=Pblmu::model()->findAll();
			$tumduk=TumDuk::model()->findAll();
			$angkahidup=AngkaHidup::model()->findAll();
			$pendudukdidik=PendudukDidik::model()->findAll();
			$keluarga=Keluarga::model()->findAll();
			$rumtang=RumTang::model()->findAll();
			$urumtang=Urumtang::model()->findAll();
			$tanilayan=TaniLayan::model()->findAll();
			$perempuananak=PerempuanAnak::model()->findAll();
			$tkunder=TkUnder::model()->findAll();
			$sarkes=SarKes::model()->findAll();
			$siif=SIIF::model()->findAll();
			$kesmas=KesMas::model()->findAll();
			$dagkes=DagKes::model()->findAll();
			$tenkes=TenKes::model()->findAll();
			$kompbidan=KompBidan::model()->findAll();
			$uci=UCI::model()->findAll();
			$pppp=PPPP::model()->findAll();
			$pkrpmm=PKRPMM::model()->findAll();
			$pkdpmm=PKDPMM::model()->findAll();
			$kunbay=KunBay::model()->findAll();
			$klb=KejadianLuarBiasa::model()->findAll();
			$siagaaktif=DesaSiagaAktif::model()->findAll();
			$didikumum=PendidikanUmum::model()->findAll();
			$senbud=SeniBudaya::model()->findAll();
			$cabudtari=CagarBudayaLestari::model()->findAll();
			$pora=PemudaOlahraga::model()->findAll();
			$expo=Expo::model()->findAll();
			$perpus=Perpustakaan::model()->findAll();
			$kpbps=KPBPS::model()->findAll();
			$lulusanke=LulusanKe::model()->findAll();
			$kualifikasiguru=KualifikasiGuru::model()->findAll();
			$penuhguru=PemenuhanGuru::model()->findAll();
			$miliksekolah=MilikSekolah::model()->findAll();
			$smkpt=SMKPT::model()->findAll();
			$luluskerja=LulusKerja::model()->findAll();
			$cabudda=CagarBudayaDaerah::model()->findAll();
			$ipm=IPM::model()->findAll();
			$jpm=JumlahPendudukMiskin::model()->findAll();
			$p1=IndeksP1::model()->findAll();
			$p2=IndeksP2::model()->findAll();
			$jamkesmasda=Jamkesmasda::model()->findAll();
			$kemiskinan=Kemiskinan::model()->findAll();
			$kmtk=KMTK::model()->findAll();
			$jkplsm=JKPLSM::model()->findAll();
			$psks=PSKS::model()->findAll();
			$pmks=PMKS::model()->findAll();
			$masos=MasalahSosial::model()->findAll();
			$pkk=PKK::model()->findAll();
			$pktk=PelayananKetenagakerjaan::model()->findAll();
			$indeksgini=IndeksGini::model()->findAll();
			$ppvbd=PPVBD::model()->findAll();
			$williamson=Williamson::model()->findAll();
			$agamapeluk=PemelukAgama::model()->findAll();
			$sarib=SaranaIbadah::model()->findAll();
			$haji=JumlahHaji::model()->findAll();
			$kua=JumlahKUA::model()->findAll();
			$penyuluhagama=PenyuluhAgama::model()->findAll();
			$lembagadidik=LembagaKeagamaan::model()->findAll();
			$tahunini=date("Y");
			$this->render("index",array(
				"dataLuasWilayah"=>$luaswilayah,
				"dataTopografi"=>$topografi,
				"dataLuasLahan"=>$luaslahan,
				"dataIklimRata"=>$iklimrata,
				"dataPulau"=>$pulau,
				"dataGunung"=>$jmlgunung,
				"dataBatasDarat"=>$batasdarat,
				"dataFisiografi"=>$fisiografi,
				"dataAdminPmr"=>$adminpmr,
				"dataOtonomi"=>$statotom,
				"dataPerdaIjin"=>$perdaijin,
				"dataSarpras"=>$sarpras,
				"dataKonSarpras"=>$konsarpras,
				"dataCapil"=>$capil,
				"dataOrangLahan"=>$orglahan,
				"dataFamJob"=>$famjob,
				"dataOrgUsia"=>$orgusia,
				"dataDeprat"=>$deprat,
				"dataDatduk"=>$datduk,
				"dataInoutsave"=>$inoutsave,
				"dataTenagakerja"=>$tk,
				"dataPblmu"=>$pblmu,
				"dataTumduk"=>$tumduk,
				"dataAngkaHidup"=>$angkahidup,
				"dataPendudukDidik"=>$pendudukdidik,
				"dataKeluarga"=>$keluarga,
				"dataRumtang"=>$rumtang,
				"dataUrumtang"=>$urumtang,
				"dataTanilayan"=>$tanilayan,
				"dataPAnak"=>$perempuananak,
				"dataTkunder"=>$tkunder,
				"dataSarkes"=>$sarkes,
				"dataSIIF"=>$siif,
				"dataKesmas"=>$kesmas,
				"dataDagkes"=>$dagkes,
				"dataTenkes"=>$tenkes,
				"dataKompbidan"=>$kompbidan,
				"dataUci"=>$uci,
				"dataPPPP"=>$pppp,
				"dataPKRPMM"=>$pkrpmm,
				"dataPKDPMM"=>$pkdpmm,
				"dataKunbay"=>$kunbay,
				"dataKlb"=>$klb,
				"dataSiagaaktif"=>$siagaaktif,
				"dataDidikumum"=>$didikumum,
				"dataSenbud"=>$senbud,
				"dataCabudtari"=>$cabudtari,
				"dataPora"=>$pora,
				"dataExpo"=>$expo,
				"dataPerpus"=>$perpus,
				"dataKPBPS"=>$kpbps,
				"dataLulusanke"=>$lulusanke,
				"dataKualifikasiguru"=>$kualifikasiguru,
				"dataPenuhguru"=>$penuhguru,
				"dataMiliksekolah"=>$miliksekolah,
				"dataSMKPT"=>$smkpt,
				"dataLuluskerja"=>$luluskerja,
				"dataCabudda"=>$cabudda,
				"dataIPM"=>$ipm,
				"dataJPM"=>$jpm,
				"dataP1"=>$p1,
				"dataP2"=>$p2,
				"dataJamkesmasda"=>$jamkesmasda,
				"dataKemiskinan"=>$kemiskinan,
				"dataKMTK"=>$kmtk,
				"dataJPKLSM"=>$jkplsm,
				"dataPSKS"=>$psks,
				"dataPMKS"=>$pmks,
				"dataMasos"=>$masos,
				"dataPKK"=>$pkk,
				"dataPKTK"=>$pktk,
				"dataIndeksGini"=>$indeksgini,
				"dataPPVBD"=>$ppvbd,
				"dataWilliamson"=>$williamson,
				"dataAgamaPeluk"=>$agamapeluk,
				"dataSarib"=>$sarib,
				"dataHaji"=>$haji,
				"dataKUA"=>$kua,
				"dataPenyuluhagama"=>$penyuluhagama,
				"dataLembagaAgama"=>$lembagadidik,
				"tahunini"=>$tahunini
				));
			}
		}

		//membuat function untuk export data ke excel
		public function actionToexcel($fileName)
		{
			$this -> createExcel($fileName);
			$luaswilayah=LuasWilayah::model()->findAll();
			$topografi=Topografi::model()->findAll();
			$luaslahan=LuasLahan::model()->findAll();
			$iklimrata=IklimRata::model()->findAll();
			$pulau=JmlPulau::model()->findAll();
			$jmlgunung=JmlGunung::model()->findAll();
			$batasdarat=BatasDarat::model()->findAll();
			$fisiografi=Fisiografi::model()->findAll();
			$adminpmr=AdministrasiPemerintah::model()->findAll();
			$statotom=StatusOtonomi::model()->findAll();
			$perdaijin=PerdaIjin::model()->findAll();
			$sarpras=SarPras::model()->findAll();
			$konsarpras=KondisiSarPras::model()->findAll();
			$capil=Capil::model()->findAll();
			$orglahan=OrangPunyaLahan::model()->findAll();
			$famjob=FamJob::model()->findAll();
			$orgusia=OrangUsia::model()->findAll();
			$deprat=Deprat::model()->findAll();
			$datduk=PadatPenduduk::model()->findAll();
			$inoutsave=Inoutsave::model()->findAll();
			$tk=Ketenagakerjaan::model()->findAll();
			$pblmu=Pblmu::model()->findAll();
			$tumduk=TumDuk::model()->findAll();
			$angkahidup=AngkaHidup::model()->findAll();
			$pendudukdidik=PendudukDidik::model()->findAll();
			$keluarga=Keluarga::model()->findAll();
			$rumtang=RumTang::model()->findAll();
			$urumtang=Urumtang::model()->findAll();
			$tanilayan=TaniLayan::model()->findAll();
			$perempuananak=PerempuanAnak::model()->findAll();
			$tkunder=TkUnder::model()->findAll();
			$sarkes=SarKes::model()->findAll();
			$siif=SIIF::model()->findAll();
			$kesmas=KesMas::model()->findAll();
			$dagkes=DagKes::model()->findAll();
			$tenkes=TenKes::model()->findAll();
			$kompbidan=KompBidan::model()->findAll();
			$uci=UCI::model()->findAll();
			$pppp=PPPP::model()->findAll();
			$pkrpmm=PKRPMM::model()->findAll();
			$pkdpmm=PKDPMM::model()->findAll();
			$kunbay=KunBay::model()->findAll();
			$klb=KejadianLuarBiasa::model()->findAll();
			$siagaaktif=DesaSiagaAktif::model()->findAll();
			$didikumum=PendidikanUmum::model()->findAll();
			$senbud=SeniBudaya::model()->findAll();
			$cabudtari=CagarBudayaLestari::model()->findAll();
			$pora=PemudaOlahraga::model()->findAll();
			$expo=Expo::model()->findAll();
			$perpus=Perpustakaan::model()->findAll();
			$kpbps=KPBPS::model()->findAll();
			$lulusanke=LulusanKe::model()->findAll();
			$kualifikasiguru=KualifikasiGuru::model()->findAll();
			$penuhguru=PemenuhanGuru::model()->findAll();
			$miliksekolah=MilikSekolah::model()->findAll();
			$smkpt=SMKPT::model()->findAll();
			$luluskerja=LulusKerja::model()->findAll();
			$cabudda=CagarBudayaDaerah::model()->findAll();
			$ipm=IPM::model()->findAll();
			$jpm=JumlahPendudukMiskin::model()->findAll();
			$p1=IndeksP1::model()->findAll();
			$p2=IndeksP2::model()->findAll();
			$jamkesmasda=Jamkesmasda::model()->findAll();
			$kemiskinan=Kemiskinan::model()->findAll();
			$kmtk=KMTK::model()->findAll();
			$jkplsm=JKPLSM::model()->findAll();
			$psks=PSKS::model()->findAll();
			$pmks=PMKS::model()->findAll();
			$masos=MasalahSosial::model()->findAll();
			$pkk=PKK::model()->findAll();
			$pktk=PelayananKetenagakerjaan::model()->findAll();
			$indeksgini=IndeksGini::model()->findAll();
			$ppvbd=PPVBD::model()->findAll();
			$williamson=Williamson::model()->findAll();
			$agamapeluk=PemelukAgama::model()->findAll();
			$sarib=SaranaIbadah::model()->findAll();
			$haji=JumlahHaji::model()->findAll();
			$kua=JumlahKUA::model()->findAll();
			$penyuluhagama=PenyuluhAgama::model()->findAll();
			$lembagadidik=LembagaKeagamaan::model()->findAll();
			$tahunini=date("Y");

			//render partial ke file index dengan membawa data $topografi dan akan ditampung oleh $dataExcel
			$dataExcel=$this->renderPartial("report",array(
				"dataLuasWilayah"=>$luaswilayah,
				"dataTopografi"=>$topografi,
				"dataLuasLahan"=>$luaslahan,
				"dataIklimRata"=>$iklimrata,
				"dataPulau"=>$pulau,
				"dataGunung"=>$jmlgunung,
				"dataBatasDarat"=>$batasdarat,
				"dataFisiografi"=>$fisiografi,
				"dataAdminPmr"=>$adminpmr,
				"dataOtonomi"=>$statotom,
				"dataPerdaIjin"=>$perdaijin,
				"dataSarpras"=>$sarpras,
				"dataKonSarpras"=>$konsarpras,
				"dataCapil"=>$capil,
				"dataOrangLahan"=>$orglahan,
				"dataFamJob"=>$famjob,
				"dataOrgUsia"=>$orgusia,
				"dataDeprat"=>$deprat,
				"dataDatduk"=>$datduk,
				"dataInoutsave"=>$inoutsave,
				"dataTenagakerja"=>$tk,
				"dataPblmu"=>$pblmu,
				"dataTumduk"=>$tumduk,
				"dataAngkaHidup"=>$angkahidup,
				"dataPendudukDidik"=>$pendudukdidik,
				"dataKeluarga"=>$keluarga,
				"dataRumtang"=>$rumtang,
				"dataUrumtang"=>$urumtang,
				"dataTanilayan"=>$tanilayan,
				"dataPAnak"=>$perempuananak,
				"dataTkunder"=>$tkunder,
				"dataSarkes"=>$sarkes,
				"dataSIIF"=>$siif,
				"dataKesmas"=>$kesmas,
				"dataDagkes"=>$dagkes,
				"dataTenkes"=>$tenkes,
				"dataKompbidan"=>$kompbidan,
				"dataUci"=>$uci,
				"dataPPPP"=>$pppp,
				"dataPKRPMM"=>$pkrpmm,
				"dataPKDPMM"=>$pkdpmm,
				"dataKunbay"=>$kunbay,
				"dataKlb"=>$klb,
				"dataSiagaaktif"=>$siagaaktif,
				"dataDidikumum"=>$didikumum,
				"dataSenbud"=>$senbud,
				"dataCabudtari"=>$cabudtari,
				"dataPora"=>$pora,
				"dataExpo"=>$expo,
				"dataPerpus"=>$perpus,
				"dataKPBPS"=>$kpbps,
				"dataLulusanke"=>$lulusanke,
				"dataKualifikasiguru"=>$kualifikasiguru,
				"dataPenuhguru"=>$penuhguru,
				"dataMiliksekolah"=>$miliksekolah,
				"dataSMKPT"=>$smkpt,
				"dataLuluskerja"=>$luluskerja,
				"dataCabudda"=>$cabudda,
				"dataIPM"=>$ipm,
				"dataJPM"=>$jpm,
				"dataP1"=>$p1,
				"dataP2"=>$p2,
				"dataJamkesmasda"=>$jamkesmasda,
				"dataKemiskinan"=>$kemiskinan,
				"dataKMTK"=>$kmtk,
				"dataJPKLSM"=>$jkplsm,
				"dataPSKS"=>$psks,
				"dataPMKS"=>$pmks,
				"dataMasos"=>$masos,
				"dataPKK"=>$pkk,
				"dataPKTK"=>$pktk,
				"dataIndeksGini"=>$indeksgini,
				"dataPPVBD"=>$ppvbd,
				"dataWilliamson"=>$williamson,
				"dataAgamaPeluk"=>$agamapeluk,
				"dataSarib"=>$sarib,
				"dataHaji"=>$haji,
				"dataKUA"=>$kua,
				"dataPenyuluhagama"=>$penyuluhagama,
				"dataLembagaAgama"=>$lembagadidik,
				"tahunini"=>$tahunini,
				));

			//echo dataExcel dan akan mendownload file excel
			echo $dataExcel;
		}
	}

?>